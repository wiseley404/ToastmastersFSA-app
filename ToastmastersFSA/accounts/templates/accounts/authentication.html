{% extends 'accounts/auth_base.html' %}
{% load static %}
{% block title %}
    {% if signup_form %}Inscription{% else %}Connexion{% endif %} - Toastmasters FSA-ULaval
{% endblock %}

{% block auth_content %}
    <!-- Messages -->
    {% if message %}
    <div class="alert alert-success">
        {{ message }}
    </div>
    {% endif %}

    {% if form.non_field_errors %}
    <div class="alert alert-danger">
        {{ form.non_field_errors }}
    </div>
    {% endif %}

    <!-- Tabs -->
    <div class="auth-tabs">
        <button class="auth-tab {% if not signup_form %}active{% endif %}" id="login-tab" data-tab="login">Se connecter</button>
        <button class="auth-tab {% if signup_form %}active{% endif %}" id="signup-tab" data-tab="signup">Créer un compte</button>
    </div>

    <!-- Login Form -->
    <div class="tab-content {% if not signup_form %}active{% endif %}" id="login-content">
        <div class="auth-welcome">
            <h2>Bon retour !</h2>
            <p>Connectez-vous pour accéder à votre espace</p>
        </div>
        {% if form %}
            <form method="post" action="{% url 'login' %}">
                {% csrf_token %}
                <div class="form-group">
                    {{ form.username }}
                </div>
                <div class="form-group">
                    {{ form.password }}
                </div>
                <button type="submit" class="btn-primary">Se connecter</button>
            </form>
            <div class="forgot-password">
                <a href="{% url 'password_reset' %}">Mot de passe oublié ?</a>
            </div>
        {% else %}
            <p class="redirect-link">
                <a href="{% url 'login' %}">Cliquez ici pour vous connecter</a>
            </p>
        {% endif %}
    </div>

    <!-- Signup Form -->
    <div class="tab-content {% if signup_form %}active{% endif %}" id="signup-content">
        <div class="auth-welcome">
            <h2>Bienvenue !</h2>
            <p>Créez votre compte pour rejoindre le club</p>
        </div>
        
        {% if signup_form %}
            <form method="post" action="{% url 'signup' %}">
                {% csrf_token %}
                
                <div class="form-group">
                    {{ signup_form.last_name }}
                    {% if signup_form.last_name.errors %}
                        <ul class="errorlist">
                            {% for error in signup_form.last_name.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ signup_form.first_name }}
                    {% if signup_form.first_name.errors %}
                        <ul class="errorlist">
                            {% for error in signup_form.first_name.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ signup_form.username }}
                    {% if signup_form.username.errors %}
                        <ul class="errorlist">
                            {% for error in signup_form.username.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ signup_form.email }}
                    {% if signup_form.email.errors %}
                        <ul class="errorlist">
                            {% for error in signup_form.email.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ signup_form.curriculum }}
                    {% if signup_form.curriculum.errors %}
                        <ul class="errorlist">
                            {% for error in signup_form.curriculum.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ signup_form.password1 }}
                    {% if signup_form.password1.errors %}
                        <ul class="errorlist">
                            {% for error in signup_form.password1.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if signup_form.password1.help_text %}
                        <span class="helptext">{{ signup_form.password1.help_text }}</span>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ signup_form.password2 }}
                    {% if signup_form.password2.errors %}
                        <ul class="errorlist">
                            {% for error in signup_form.password2.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                <button type="submit" class="btn-primary">Créer mon compte</button>
            </form>
        {% else %}
            <p class="redirect-link">
                <a href="{% url 'signup' %}">Cliquez ici pour créer un compte</a>
            </p>
        {% endif %}
    </div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'accounts/js/auth_tabs.js' %}"></script>
{% endblock %}