{% extends 'base_login.html' %}
{% load static %}

{% block title %} Paramètres {% endblock %}
{% block head %}
    <script type="text/javascript" src="{% static 'core/js/init_board_form.js' %}" defer></script>
    <link rel="stylesheet" href="{% static 'core/css/settings.css' %}?v=1">
{% endblock %}

{% block body %}
{% include 'includes/popup.html' %}
<div class="page-container">
<div class="page-header">
<h2>Paramètres</h2>
{% if user.is_staff %}
<div class="container">
  <button class="toggle-text-btn {% if current_section == 'club' %}active{% endif %}" data-target="club-section">Club</button>
  <button class="toggle-text-btn {% if current_section == 'website' %}active{% endif %}" data-target="website-section">Website</button>
</div>
</div>

<div class="section-content {% if current_section == 'club' %}active{% endif %}" id="club-section" 
     style="display:{% if current_section == 'club' %}block{% else %}none{% endif %};">
<div class="page-header">
    <a href="{% url 'add_member_to_board' %}">
        <button type="button" class="action-btn" data-create-url="{% url 'add_member_to_board' %}">Nouveau role</button>
    </a>
</div>

<div class="club-board-settings-section">  
    <h3 class="section-title">Gestion du comité</h3> 
    <div class="table-wrapper"> 
        <table class="table">
                <thead>
                    <tr>
                        <th>Role</th>
                        <th>Responsable</th>
                        <th>Entree en fonction</th>
                        <th>Sortie en fonction</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for member in comite %}
                        <tr>
                            <td>{{ member.role|title }}</td>
                            <td>{{ member.profile.user.get_full_name|title|default:"-" }}</td>
                            <td>{{ member.start_date }}</td>
                            <td>{{ member.end_date|default:"-" }}</td>
                            <td>
                                <a href="{% url 'edit_board_role' member.id %}">
                                    <button type="button" title="Modifier" class="edit-btn" data-edit-url="{% url 'edit_board_role' member.id %}"><i class="fas fa-edit"></i></button>
                                </a> 

                                <a  href="{% url 'confirm_board_profile_remove' member.id %}"></a>
                                    <button type="button" title="Supprimer" class="delete-btn" 
                                        data-delete-url="{% url 'confirm_board_profile_remove' member.id %}">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </a>
                            </td>
                        </tr>
                    {% empty %}
                        <tr><td colspan="3">Aucun comité pour l'instant</td></tr>
                    {% endfor %}
                </tbody>
            </table>
    </div>
</div>

<div class="club-members-settings-section">  
    <h3 class="section-title">Gestion des membres</h3> 
    <div class="table-wrapper"> 
        <table class="table">
                <thead>
                    <tr>
                        <th>Nom</th>
                        <th>Prenom</th>
                        <th>Nom d'utilisateur</th>
                        <th>Statut</th>
                        <th>Programme</th>
                        <th>E-mail</th>
                        <th>Telephone</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for member in club_members %}
                        <tr>
                            <td>{{ member.user.last_name|title|default:"-" }}</td>
                            <td>{{ member.user.first_name|title|default:"-" }}</td>
                            <td>{{ member.user.username|title|default:"-" }}</td>
                            <td>{{ member.statuts.all |join:" / "|default:"-" }}</td>
                            <td>{{ member.curriculums.all |join:" / "|default:"-" }}</td>
                            <td>{{ member.user.email|default:"-" }}</td>
                            <td>{{ member.telephone|default:"-" }}</td>
                            <td>
                                <a href="{% url 'edit_member_profile' member.id %}">
                                    <button type="button" title="Modifier" class="edit-btn" data-edit-url="{% url 'edit_member_profile' member.id %}"><i class="fas fa-edit"></i></button>
                                </a> 
                            </td>
                        </tr>
                    {% empty %}
                        <tr><td colspan="8">Aucun membre pour l'instant</td></tr>
                    {% endfor %}
                </tbody>
            </table>
    </div>
</div>

</div>

</div>


<div  class="section-content {% if current_section == 'website' %}active{% endif %}" id="website-section" 
      style="display:{% if current_section == 'website' %}block{% else %}none{% endif %};">
 <form method="post" action="{% url 'update_social_links' %}">
    {% csrf_token %}
    
    <div class="settings-page">
        
        <!-- Réseaux sociaux -->
        <div class="settings-section">
            <div class="section-header">
                <h3>Réseaux sociaux & Contact</h3>
                <p class="section-description">Ajoutez vos liens pour qu'ils apparaissent au bas du site, dans les mails, etc...</p>
            </div>
            <div class="settings-content">
                <div class="social-links-grid">
                    
                    <div class="social-link-field">
                        <div class="social-link-label">
                            <i class="fab fa-facebook"></i>
                            <span>Facebook</span>
                        </div>
                        <input type="url" name="facebook" value="{{ social_links_dict.facebook|default:'' }}" placeholder="https://facebook.com/votre-page">
                    </div>
                    
                    <div class="social-link-field">
                        <div class="social-link-label">
                            <i class="fab fa-instagram"></i>
                            <span>Instagram</span>
                        </div>
                        <input type="url" name="instagram" value="{{ social_links_dict.instagram|default:'' }}" placeholder="https://instagram.com/votre-compte">
                    </div>
                    
                    <div class="social-link-field">
                        <div class="social-link-label">
                            <i class="fab fa-linkedin"></i>
                            <span>LinkedIn</span>
                        </div>
                        <input type="url" name="linkedin" value="{{ social_links_dict.linkedin|default:'' }}" placeholder="https://linkedin.com/company/votre-page">
                    </div>
                    
                    <div class="social-link-field">
                        <div class="social-link-label">
                            <i class="fab fa-twitter"></i>
                            <span>Twitter / X</span>
                        </div>
                        <input type="url" name="twitter" value="{{ social_links_dict.twitter|default:'' }}" placeholder="https://twitter.com/votre-compte">
                    </div>
                    
                    <div class="social-link-field">
                        <div class="social-link-label">
                            <i class="fab fa-youtube"></i>
                            <span>YouTube</span>
                        </div>
                        <input type="url" name="youtube" value="{{ social_links_dict.youtube|default:'' }}" placeholder="https://youtube.com/votre-chaine">
                    </div>
                    
                    <div class="social-link-field">
                        <div class="social-link-label">
                            <i class="fab fa-tiktok"></i>
                            <span>TikTok</span>
                        </div>
                        <input type="url" name="tiktok" value="{{ social_links_dict.tiktok|default:'' }}" placeholder="https://tiktok.com/@votre-compte">
                    </div>
                    
                    <div class="social-link-field full-width">
                        <div class="social-link-label">
                            <i class="fas fa-envelope"></i>
                            <span>Email de contact</span>
                        </div>
                        <input type="email" name="contact" value="{{ social_links_dict.contact|default:'' }}" placeholder="contact@votreclub.com">
                    </div>
                    
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn-save">
                      Enregistrer
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Placeholder pour futures fonctionnalités -->
        <div class="settings-section coming-soon">
            <div class="section-header">
                <h3>Site public</h3>
                <span class="badge-soon">Bientôt</span>
            </div>
            <div class="settings-content">
                <div class="coming-soon-content">
                    <i class="fas fa-globe"></i>
                    <p>La personnalisation du site public sera bientôt disponible.</p>
                </div>
            </div>
        </div>
        
    </div>
    
    </form>

    <script>
        document.querySelectorAll('.toggle-text-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const target = this.dataset.target;
                
                document.querySelectorAll('.section-content').forEach(s => s.style.display = 'none');
                
                const section = document.getElementById(target);
                if (section) {
                    section.style.display = 'block';
                }
                
                document.querySelectorAll('.toggle-text-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });
    </script>
</div>
{% endif %}
</div>
{% endblock %}


